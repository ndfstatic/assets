{"version":3,"sources":["webpack:///./src/views/product/Url.vue?fe4f","webpack:///src/views/product/Url.vue","webpack:///./src/views/product/Url.vue?618b","webpack:///./src/views/product/Url.vue?d3b8","webpack:///./src/views/product/Url.vue?3535"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","staticClass","class","url","attrs","app","autoExchange","_v","_s","errorMsg","_e","user","roles","indexOf","tryUsername","tryPwd","tryUrl","try_btn","style","staticRenderFns","component"],"mappings":"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","file":"static/js/chunk-054b8266.b33d5966.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"product-url\",class:{url: !!_vm.url },attrs:{\"element-loading-text\":_vm.app.autoExchange ? '余额自动转入游戏中' : '加载中',\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0.8)\"}},[(_vm.errorMsg)?_c('div',{staticClass:\"error_msg\"},[_vm._v(\"\\n        \"+_vm._s(_vm.errorMsg)+\"\\n    \")]):_vm._e(),(_vm.user.roles.indexOf('guest') > -1)?_c('div',{staticClass:\"text\"},[_vm._v(\"请先登录账户\")]):_vm._e(),(_vm.url)?_c('iframe',{staticClass:\"frame\",attrs:{\"src\":_vm.url}}):_vm._e(),(_vm.tryUsername || _vm.tryPwd)?_c('div',{staticClass:\"text try_text\"},[(_vm.tryUsername)?_c('p',[_vm._v(\"试玩用户名：\"+_vm._s(_vm.tryUsername))]):_vm._e(),(_vm.tryPwd)?_c('p',[_vm._v(\"试玩密码：\"+_vm._s(_vm.tryPwd))]):_vm._e(),_c('a',{attrs:{\"href\":_vm.tryUrl,\"target\":\"_blank\"}},[_c('el-button',{class:_vm.try_btn,style:({'padding-left': 20, 'padding-right': 20 }),attrs:{\"type\":\"primary\"}},[_vm._v(\"前往试玩\")])],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"product-url\" \n        :class=\"{url: !!url }\"\n        v-loading=\"loading\"\n        :element-loading-text=\"app.autoExchange ? '余额自动转入游戏中' : '加载中'\"\n        element-loading-spinner=\"el-icon-loading\"\n        element-loading-background=\"rgba(0, 0, 0, 0.8)\"\n    >\n        <div v-if=\"errorMsg\" class=\"error_msg\">\n            {{ errorMsg }}\n        </div>\n        <div class=\"text\" v-if=\"user.roles.indexOf('guest') > -1\">请先登录账户</div>\n        <iframe :src=\"url\" v-if=\"url\" class=\"frame\"></iframe>\n        \n        <div class=\"text try_text\" v-if=\"tryUsername || tryPwd\">\n            <p v-if=\"tryUsername\">试玩用户名：{{ tryUsername }}</p>\n            <p v-if=\"tryPwd\">试玩密码：{{ tryPwd }}</p>\n            <a :href=\"tryUrl\" target=\"_blank\">\n              <el-button type=\"primary\" :class=\"try_btn\" :style=\"{'padding-left': 20, 'padding-right': 20 }\">前往试玩</el-button>\n            </a>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { getUrl, getTryUrl, transferallout } from '@/api/product'\nimport { transfer } from '@/api/user'\n\nexport default {\n    name: 'Product-Url',\n    components: {\n    },\n\n    data() {\n        return {\n            loading: false,\n            url: '',\n            errorMsg: '',\n            tryUsername: '',\n            tryPwd: '',\n            tryUrl: '',\n        }\n    },\n\n    computed: {\n\t\tapp() { return this.$store.getters.app },\n\t\tuser() { return this.$store.getters.user },\n\t\tproduct() { return this.$store.getters.product },\n        productId() { return this.$route.query.id },\n        gameType() { return this.$route.query.game_type },\n        \n        filterProduct() {\n            const checkNavIsShow = (id) => {\n                let res = false;\n                this.product.navList.forEach(nav => {\n                    nav.list && nav.list.forEach(p => {\n                        if(p.id == id) {\n                            if(nav.is_show == 'Y') {\n                                res = true;\n                            } \n                        }\n                    })\n                })\n\n                return res;\n            }\n\n            const list = this.product.list.filter(item => {\n                return item.is_show == 'Y' && checkNavIsShow(item.id);\n            });\n\n            return list;\n        }\n    },\n\n    mounted() {\n        this.init()\n    },\n\n    methods: {\n        init() {\n            // console.log(this.productId);\n            // console.log(this.gameType);\n\n            // this.getProductUrl();\n            // return ;\n\n            // 检查是否维护\n            const test = this.$route.query.test == 'sybet';\n\n            let errorMsg = '';\n\n            this.product.list.forEach(item => {\n                if(item.id == this.productId) {\n                    if(item.is_fix == 'Y') {\n                        errorMsg = '接口维护中';\n                    }\n                }\n            })\n\n            if(errorMsg && !test) {\n                this.errorMsg = errorMsg;\n                return ;\n            }\n\n            if(this.user.roles.indexOf('user') > -1) {\n                if(this.app.autoExchange) {\n                    this.reloadBalance((hadExchange) => {\n                        if(hadExchange) {\n                            const product_ids = this.filterProduct.map(item => { return item.id }).join(',');\n                            this.$store.dispatch('productBalanceByAjax', { product_ids });\n                        }\n                        \n                        this.getProductUrl();\n                    });\n                }else {\n                    this.getProductUrl();\n                }\n            }else if(this.user.roles.indexOf('try') > -1) {\n                this.getProductTryUrl();\n            }\n        },\n\n        getProductUrl() {\n            \n            const data = {\n                product_id: this.productId,\n                game_type: this.gameType,\n            };\n\n            this.loading = true;\n            getUrl(data).then(json => {\n                this.loading = false;\n                if (json.code == 200) {\n                    if(this.productId == 6) {\n                        this.url = json.list.login_url.replace('http://', '//');\n                    }else {\n                        window.location.href = json.list.login_url;\n                    }\n                } else {\n                    this.errorMsg = (json.info);\n                }\n            });\n        },\n\n        getProductTryUrl() {\n            \n            const data = {\n                product_id: this.productId,\n                game_type: this.gameType,\n            };\n\n            this.loading = true;\n            getTryUrl(data).then(json => {\n                this.loading = false;\n                if (json.code == 200) {\n                    if(this.productId == 6) {\n                        this.url = json.list.login_url.replace('http://', '//');\n                    }else {\n                        if(json.list.username || json.list.password) {\n                            this.tryUsername = json.list.username;\n                            this.tryPwd = json.list.password;\n                            this.tryUrl = json.list.login_url;\n                        }else {\n                            window.location.href = json.list.login_url;   \n                        }\n                    }\n                } else {\n                    this.errorMsg = (json.info);\n                }\n            });\n        },\n\n        reloadBalance(callback) {\n            const product_ids = this.filterProduct.map(item => { return item.id }).join(',');\n            this.loading = true;\n            this.$store.dispatch('productBalanceByAjax', { product_ids }).then((json) => {\n                if(json.code == 200) {\n                    let idArr = [], total_money = 0;\n                    for(let id in json.list) {\n                        const money = Number(json.list[id].money);\n                        \n                        if(id != 0 && id != this.productId) {\n                            // 大于 0 则 回收\n                            if(money > 0) {\n                                idArr.push(id);\n                            }\n                        }\n\n                        if(id == 0) {\n                            total_money = money\n                        }\n                    }\n\n                    if(idArr.length) {\n                        const data = {\n                            type: 3,\n                            product_id: idArr.join(','),\n                        }\n\n                        transfer(data).then(json => {\n                            if (json.code == 200) {\n                                transferallout(this.productId).then(() => {\n                                    setTimeout(() => {\n                                        this.loading = false;\n                                        callback && callback(1);\n                                    }, 3000);     \n                                })\n                            } else {\n                                this.errorMsg = (json.info);\n                                this.loading = false;\n                                callback && callback();\n                            }\n                        });\n                    }else {\n                        if(total_money > 0) {\n                            transferallout(this.productId).then(() => {\n                                this.loading = false;\n                                callback && callback();\n                            })\n                        }else {\n                            this.loading = false;\n                            callback && callback();\n                        }\n                    }\n\n                }else {\n                    this.errorMsg = (json.info);\n                    this.loading = false;\n                    callback && callback();\n                }\n            });\n        },\n\n    }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"scss\">\n\n.product-url {\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n\n    &.url {\n        // position: static;\n        // height: 100%;\n    }\n\n    .text {\n        font-size: 30px;\n        text-align: center;\n        margin-top: 100px;\n        color: #a7a6a6;\n    }\n\n\t.frame {\n\t\twidth: 100%;\n\t    height: 100%;\n\t    overflow-x: hidden;\n\t    margin: 0;\n\t    padding: 0;\n        border: none;\n    }\n\n    .error_msg {\n        height: 100%;\n        text-align: center;\n        color: #f56c6c;\n        padding: 100px 0;\n        font-size: 20px;\n    }\n    \n    .try_text {\n         font-size: 24px;\n    \n        .el-button {\n            padding-left: 40px;\n            padding-right: 40px;\n            font-size: 20px;\n        }   \n    }\n}\n\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Url.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Url.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Url.vue?vue&type=template&id=27104ca2&\"\nimport script from \"./Url.vue?vue&type=script&lang=js&\"\nexport * from \"./Url.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Url.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Url.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Url.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}